{{ $post_class := $.Site.Params.post_class }}

<script
    src="{{ "js/lite-yt-embed.js" | relURL }}"
    defer
    onerror="console.error('Failed to load lite-youtube web component:', this.src)">
</script>

<script
    src="{{ "js/lite-youtube-processor.js" | relURL }}"
    defer
    onerror="console.error('Failed to load lite-youtube processor:', this.src)">
</script>

<script>
    (function() {
        'use strict';

        const postClass = '{{ or $post_class "post-content" }}';

        function initializePlugin() {
            // Check if the processor loaded successfully
            if (typeof window.initLiteYouTube !== 'function') {
                console.error('lite-youtube-processor.js failed to load or initialize');
                return;
            }

            try {
                window.initLiteYouTube(postClass);
            } catch (err) {
                console.error('Error initializing lite-youtube:', err);
            }
        }

        // Initialize when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializePlugin);
        } else {
            // DOM already loaded (e.g., when scripts are deferred)
            initializePlugin();
        }
    })();
</script>
